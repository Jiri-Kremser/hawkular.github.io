

== Base Path
#`http://localhost:8080/hawkular-metrics/`#

== REST APIs
=== Metrics related REST interface



==============================================
*Endpoint* `/{tenantId}/availability`


NOTE: *Find availabilities metrics data by their tags.* 

*Method*
****
*GET* `/{tenantId}/availability`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
|=======================
*query parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tags|true|Tag list|<<Tags,Tags>>
|=======================

*Response* +
List[Map]

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Successfully fetched data. | -
| 204    | No matching data found. | -
| 400    | Missing or invalid tags query | [ApiError](#<<ApiError>>)
| 500    | Any error in the query. | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/metrics/numeric/{id}/data`


NOTE: *Retrieve numeric data. When buckets or bucketDuration query parameter is used, the time range between start and end will be divided in buckets of equal duration, and metric statistics will be computed for each bucket.* 

*Method*
****
*GET* `/{tenantId}/metrics/numeric/{id}/data`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
    |id|true||string
|=======================
*query parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |start|false|Defaults to now - 8 hours|long
    |end|false|Defaults to now|long
    |buckets|false|Total number of buckets|int
    |bucketDuration|false|Bucket duration|<<Duration,Duration>>
|=======================

*Response* +
List

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Successfully fetched numeric data. | -
| 204    | No numeric data was found. | -
| 400    | buckets or bucketDuration parameter is invalid, or both are used. | [ApiError](#<<ApiError>>)
| 500    | Unexpected error occurred while fetching numeric data. | [ApiError](#<<ApiError>>)

|=======================

{empty} +

NOTE: *Add data for a single numeric metric.* 

*Method*
****
*POST* `/{tenantId}/metrics/numeric/{id}/data`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
    |id|true||string
|=======================
*body parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |body|true|List of datapoints containing timestamp and value|<<NumericData,List[NumericData]>>
|=======================

*Response* +
void

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Adding data succeeded. | -
| 400    | Missing or invalid payload | [ApiError](#<<ApiError>>)
| 500    | Unexpected error happened while storing the data | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/metrics/numeric/{id}/periods`


NOTE: *Retrieve periods for which the condition holds true for each consecutive data point.* 

*Method*
****
*GET* `/{tenantId}/metrics/numeric/{id}/periods`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
    |id|true||string
|=======================
*query parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |start|false|Defaults to now - 8 hours|long
    |end|false|Defaults to now|long
    |threshold|true|A threshold against which values are compared|double
    |op|true|A comparison operation to perform between values and the threshold. Supported operations include ge, gte, lt, lte, and eq|string
|=======================

*Response* +
List

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Successfully fetched periods. | -
| 204    | No numeric data was found. | -
| 400    | Missing or invalid query parameters | -

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/metrics/availability/{id}/data`


NOTE: *Retrieve availability data. When buckets or bucketDuration query parameter is used, the time range between start and end will be divided in buckets of equal duration, and availability statistics will be computed for each bucket.* 

*Method*
****
*GET* `/{tenantId}/metrics/availability/{id}/data`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
    |id|true||string
|=======================
*query parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |start|false|Defaults to now - 8 hours|long
    |end|false|Defaults to now|long
    |buckets|false|Total number of buckets|int
    |bucketDuration|false|Bucket duration|<<Duration,Duration>>
|=======================

*Response* +
List

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Successfully fetched availability data. | -
| 204    | No availability data was found. | -
| 400    | buckets or bucketDuration parameter is invalid, or both are used. | [ApiError](#<<ApiError>>)
| 500    | Unexpected error occurred while fetching availability data. | [ApiError](#<<ApiError>>)

|=======================

{empty} +

NOTE: *Add data for a single availability metric.* 

*Method*
****
*POST* `/{tenantId}/metrics/availability/{id}/data`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
    |id|true||string
|=======================
*body parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |body|true|List of availability datapoints|<<Availability,List[Availability]>>
|=======================

*Response* +
void

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Adding data succeeded. | -
| 400    | Missing or invalid payload | [ApiError](#<<ApiError>>)
| 500    | Unexpected error happened while storing the data | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/metrics/numeric/{id}/tag`


NOTE: *Add or update numeric metric&#39;s tags.* 

*Method*
****
*POST* `/{tenantId}/metrics/numeric/{id}/tag`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
    |id|true||string
|=======================
*body parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |body|true||<<TagRequest,TagRequest>>
|=======================

*Response* +
void

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Tags were modified successfully. | -

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/metrics/availability/{id}/tag`


NOTE: *Add or update availability metric&#39;s tags.* 

*Method*
****
*POST* `/{tenantId}/metrics/availability/{id}/tag`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
    |id|true||string
|=======================
*body parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |body|true||<<TagRequest,TagRequest>>
|=======================

*Response* +
void

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Tags were modified successfully. | -

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/tags/numeric/{tags}`


NOTE: *Find numeric metric data with given tags.* 

*Method*
****
*GET* `/{tenantId}/tags/numeric/{tags}`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
    |tags|true|Tag list|<<Tags,Tags>>
|=======================

*Response* +
List[Map]

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Numeric values fetched successfully | -
| 204    | No matching data found. | -
| 400    | Invalid tags | [ApiError](#<<ApiError>>)
| 500    | Any error while fetching data. | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/tags/availability/{tags}`


NOTE: *Find availability metric data with given tags.* 

*Method*
****
*GET* `/{tenantId}/tags/availability/{tags}`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
    |tags|true|Tag list|<<Tags,Tags>>
|=======================

*Response* +
List[Map]

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Availability values fetched successfully | -
| 204    | No matching data found. | -
| 400    | Invalid tags | [ApiError](#<<ApiError>>)
| 500    | Any error while fetching data. | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/metrics`


NOTE: *Find tenant&#39;s metric definitions.* +
      _Does not include any metric values. _

*Method*
****
*GET* `/{tenantId}/metrics`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
|=======================
*query parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |type|true|Queried metric type|string
|=======================

*Response* +
List[List]

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Successfully retrieved at least one metric definition. | -
| 204    | No metrics found. | -
| 400    | Given type is not a valid type. | [ApiError](#<<ApiError>>)
| 500    | Failed to retrieve metrics due to unexpected error. | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/metrics/numeric`


NOTE: *Create numeric metric definition.* +
      _Clients are not required to explicitly create a metric before storing data. Doing so however allows clients to prevent naming collisions and to specify tags and data retention._

*Method*
****
*POST* `/{tenantId}/metrics/numeric`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
|=======================
*body parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |body|true||<<NumericMetric,NumericMetric>>
|=======================

*Response* +
void

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 201    | Metric definition created successfully | -
| 400    | Missing or invalid payload | [ApiError](#<<ApiError>>)
| 409    | Numeric metric with given id already exists | [ApiError](#<<ApiError>>)
| 500    | Metric definition creation failed due to an unexpected error | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/metrics/availability`


NOTE: *Create availability metric definition. Same notes as creating numeric metric apply.* 

*Method*
****
*POST* `/{tenantId}/metrics/availability`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
|=======================
*body parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |body|true||<<AvailabilityMetric,AvailabilityMetric>>
|=======================

*Response* +
void

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 201    | Metric definition created successfully | -
| 400    | Missing or invalid payload | [ApiError](#<<ApiError>>)
| 409    | Numeric metric with given id already exists | [ApiError](#<<ApiError>>)
| 500    | Metric definition creation failed due to an unexpected error | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/metrics/numeric/{id}/tags`


NOTE: *Retrieve tags associated with the metric definition.* 

*Method*
****
*GET* `/{tenantId}/metrics/numeric/{id}/tags`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
    |id|true||string
|=======================

*Response* +
Metric

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Metric&#39;s tags were successfully retrieved. | -
| 204    | Query was successful, but no metrics were found. | -
| 500    | Unexpected error occurred while fetching metric&#39;s tags. | [ApiError](#<<ApiError>>)

|=======================

{empty} +

NOTE: *Update tags associated with the metric definition.* 

*Method*
****
*PUT* `/{tenantId}/metrics/numeric/{id}/tags`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
    |id|true||string
|=======================
*body parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |body|true||<<UNKNOWN[string],UNKNOWN[string]>>
|=======================

*Response* +
void

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Metric&#39;s tags were successfully updated. | -
| 500    | Unexpected error occurred while updating metric&#39;s tags. | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/metrics/numeric/{id}/tags/{tags}`


NOTE: *Delete tags associated with the metric definition.* 

*Method*
****
*DELETE* `/{tenantId}/metrics/numeric/{id}/tags/{tags}`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
    |id|true||string
    |tags|true|Tag list|<<Tags,Tags>>
|=======================

*Response* +
void

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Metric&#39;s tags were successfully deleted. | -
| 400    | Invalid tags | [ApiError](#<<ApiError>>)
| 500    | Unexpected error occurred while trying to delete metric&#39;s tags. | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/metrics/availability/{id}/tags`


NOTE: *Retrieve tags associated with the metric definition.* 

*Method*
****
*GET* `/{tenantId}/metrics/availability/{id}/tags`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
    |id|true||string
|=======================

*Response* +
Map

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Metric&#39;s tags were successfully retrieved. | -
| 204    | Query was successful, but no metrics were found. | -
| 500    | Unexpected error occurred while fetching metric&#39;s tags. | [ApiError](#<<ApiError>>)

|=======================

{empty} +

NOTE: *Update tags associated with the metric definition.* 

*Method*
****
*PUT* `/{tenantId}/metrics/availability/{id}/tags`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
    |id|true||string
|=======================
*body parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |body|true||<<UNKNOWN[string],UNKNOWN[string]>>
|=======================

*Response* +
void

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Metric&#39;s tags were successfully updated. | -
| 500    | Unexpected error occurred while updating metric&#39;s tags. | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/metrics/availability/{id}/tags/{tags}`


NOTE: *Delete tags associated with the metric definition.* 

*Method*
****
*DELETE* `/{tenantId}/metrics/availability/{id}/tags/{tags}`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
    |id|true||string
    |tags|true|Tag list|<<Tags,Tags>>
|=======================

*Response* +
void

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Metric&#39;s tags were successfully deleted. | -
| 400    | Invalid tags | [ApiError](#<<ApiError>>)
| 500    | Unexpected error occurred while trying to delete metric&#39;s tags. | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/metrics/numeric/data`


NOTE: *Add metric data for multiple numeric metrics in a single call.* 

*Method*
****
*POST* `/{tenantId}/metrics/numeric/data`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
|=======================
*body parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |body|true|List of metrics|<<NumericMetric,List[NumericMetric]>>
|=======================

*Response* +
void

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Adding data succeeded. | -
| 500    | Unexpected error happened while storing the data | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/metrics/availability/data`


NOTE: *Add metric data for multiple availability metrics in a single call.* 

*Method*
****
*POST* `/{tenantId}/metrics/availability/data`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
|=======================
*body parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |body|true|List of availability metrics|<<AvailabilityMetric,List[AvailabilityMetric]>>
|=======================

*Response* +
void

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Adding data succeeded. | -
| 500    | Unexpected error happened while storing the data | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +



==============================================
*Endpoint* `/{tenantId}/numeric`


NOTE: *Find numeric metrics data by their tags.* 

*Method*
****
*GET* `/{tenantId}/numeric`
****

*path parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tenantId|true||string
|=======================
*query parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |tags|true|Tag list|<<Tags,Tags>>
|=======================

*Response* +
List[Map]

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Successfully fetched data. | -
| 204    | No matching data found. | -
| 400    | Missing or invalid tags query | [ApiError](#<<ApiError>>)
| 500    | Any error in the query. | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +

=== Tenants related REST interface



==============================================
*Endpoint* `/tenants`


NOTE: *Create a new tenant. * +
      _Clients are not required to create explicitly create a tenant before starting to store metric data. It is recommended to do so however to ensure that there are no tenant id naming collisions and to provide default data retention settings. _

*Method*
****
*POST* `/tenants`
****

*body parameters*

[options="header"]
|=======================
|Parameter|Required|Description|Data Type
    |body|true||<<Tenant,Tenant>>
|=======================

*Response* +
void

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 201    | Tenant has been succesfully created. | -
| 400    | Missing or invalid retention properties.  | [ApiError](#<<ApiError>>)
| 409    | Given tenant id has already been created. | [ApiError](#<<ApiError>>)
| 500    | An unexpected error occured while trying to create a tenant. | [ApiError](#<<ApiError>>)

|=======================

{empty} +

NOTE: *Returns a list of tenants.* 

*Method*
****
*GET* `/tenants`
****


*Response* +
void

*Status codes*
[options="header"]
|=======================
| Status Code | Reason      | Response Model
| 200    | Returned a list of tenants successfully. | -
| 204    | No tenants were found. | -
| 500    | Unexpected error occurred while fetching tenants. | [ApiError](#<<ApiError>>)

|=======================

{empty} +

==============================================

{empty} +


== Data Types

{empty} +

[[AggregationTemplate]]
=== AggregationTemplate
[options="header"]
|=======================
| Name | Type | Required | Description | Allowable Values
|type|MetricType|optional|-|numeric, availability, log event
|interval|Interval|optional|-|-
|functions|Set|optional|-|-
|=======================


[[ApiError]]
=== ApiError
[options="header"]
|=======================
| Name | Type | Required | Description | Allowable Values
|errorMsg|string|optional|Detailed error message of what happened|-
|=======================


[[Availability]]
=== Availability
[options="header"]
|=======================
| Name | Type | Required | Description | Allowable Values
|tTL|int|optional|-|-
|value|AvailabilityType|optional|-|AvailabilityType{code=0, text=up}, AvailabilityType{code=1, text=down}
|timestamp|long|optional|-|-
|writeTime|long|optional|-|-
|tags|Map[string,string]|optional|-|-
|=======================


[[AvailabilityMetric]]
=== AvailabilityMetric
[options="header"]
|=======================
| Name | Type | Required | Description | Allowable Values
|type|MetricType|optional|-|numeric, availability, log event
|data|Array[T]|optional|-|-
|tenantId|string|optional|-|-
|dataRetention|int|optional|-|-
|tags|Map[string,string]|optional|-|-
|id|MetricId|optional|-|-
|=======================


[[Duration]]
=== Duration
[options="header"]
|=======================
| Name | Type | Required | Description | Allowable Values
|value|string|optional|A time duration.|-
|=======================


[[Interval]]
=== Interval
[options="header"]
|=======================
| Name | Type | Required | Description | Allowable Values
|length|int|optional|-|-
|units|Units|optional|-|MINUTES, HOURS, DAYS
|=======================


[[Map]]
=== Map
[options="header"]
|=======================
| Name | Type | Required | Description | Allowable Values
|empty|boolean|optional|-|-
|=======================


[[Metric]]
=== Metric
[options="header"]
|=======================
| Name | Type | Required | Description | Allowable Values
|data|Array[T]|optional|-|-
|tenantId|string|optional|-|-
|dataRetention|int|optional|-|-
|tags|Map[string,string]|optional|-|-
|id|MetricId|optional|-|-
|=======================


[[MetricId]]
=== MetricId
[options="header"]
|=======================
| Name | Type | Required | Description | Allowable Values
|name|string|optional|-|-
|interval|Interval|optional|-|-
|=======================


[[NumericData]]
=== NumericData
[options="header"]
|=======================
| Name | Type | Required | Description | Allowable Values
|aggregatedValues|Set|optional|-|-
|tTL|int|optional|-|-
|value|double|optional|-|-
|timestamp|long|optional|-|-
|writeTime|long|optional|-|-
|tags|Map[string,string]|optional|-|-
|=======================


[[NumericMetric]]
=== NumericMetric
[options="header"]
|=======================
| Name | Type | Required | Description | Allowable Values
|type|MetricType|optional|-|numeric, availability, log event
|data|Array[T]|optional|-|-
|tenantId|string|optional|-|-
|dataRetention|int|optional|-|-
|tags|Map[string,string]|optional|-|-
|id|MetricId|optional|-|-
|=======================


[[TagRequest]]
=== TagRequest
[options="header"]
|=======================
| Name | Type | Required | Description | Allowable Values
|timestamp|long|optional|-|-
|end|long|optional|-|-
|start|long|optional|-|-
|tags|Map[string,string]|optional|-|-
|=======================


[[Tags]]
=== Tags
[options="header"]
|=======================
| Name | Type | Required | Description | Allowable Values
|value|string|optional|A list of tags, comma separated.|-
|=======================


[[Tenant]]
=== Tenant
[options="header"]
|=======================
| Name | Type | Required | Description | Allowable Values
|aggregationTemplates|Array[AggregationTemplate]|optional|-|-
|id|string|optional|-|-
|=======================


{empty} +
{empty} +
{empty} +
